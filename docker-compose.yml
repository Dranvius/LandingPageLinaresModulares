version: "3.9"

services:
  backend:
    build:
      context: ./back
    image: linaresmodulares-backend
    env_file:
      - ./.env
    environment:
      PORT: ${BACK_PORT:-3000}
      ALLOWED_ORIGIN: ${ALLOWED_ORIGIN:-http://localhost}
      SMTP_HOST: ${SMTP_HOST:-smtp.gmail.com}
      SMTP_PORT: ${SMTP_PORT:-465}
      SMTP_USER: ${SMTP_USER:-example@gmail.com}
      SMTP_PASS: ${SMTP_PASS:-changeme}
      SMTP_TO: ${SMTP_TO:-destino@empresa.com}
    ports:
      - "${BACK_PORT:-3000}:3000"
    networks:
      - webnet

  frontend:
    build:
      context: ./front/linaresmodulares-landingpage
      args:
        VITE_API_URL: ${VITE_API_URL:-http://backend:3000}
    image: linaresmodulares-frontend
    depends_on:
      - backend
    ports:
      - "${FRONT_PORT:-80}:80"
    networks:
      - webnet

networks:
  webnet:
    driver: bridge
